/**
 * WP Direct API Updater ‚Äî pushes ALL 50 state pages via Node.js
 * Uses WP REST API with cookie auth forwarded from browser nonce.
 * 
 * Usage: node scripts/wp-push-all-states.js
 */
const https = require('https');
const path = require('path');

// ‚îÄ‚îÄ‚îÄ CONFIG ‚îÄ‚îÄ‚îÄ
const WP_HOST = 'y8e.62b.myftpupload.com';
const APP = 'https://app.thefoundationofchange.org';

// WordPress application password auth
const WP_USER = 'rapidrl';
const WP_APP_PASS = 'RFZ1 EWoH iYS0 KLgc Bk4f mvSS';
const AUTH = 'Basic ' + Buffer.from(`${WP_USER}:${WP_APP_PASS}`).toString('base64');

function wpAPI(path, method = 'GET', body = null) {
    return new Promise((resolve, reject) => {
        const options = {
            hostname: WP_HOST,
            path: path,
            method: method,
            headers: {
                'Authorization': AUTH,
                'Content-Type': 'application/json',
                'User-Agent': 'TFC-Rebuild/2.0',
            },
        };
        const req = https.request(options, (res) => {
            let data = '';
            res.on('data', c => data += c);
            res.on('end', () => {
                try { resolve({ status: res.statusCode, body: JSON.parse(data) }); }
                catch (e) { resolve({ status: res.statusCode, body: data.substring(0, 500) }); }
            });
        });
        req.on('error', reject);
        if (body) req.write(typeof body === 'string' ? body : JSON.stringify(body));
        req.end();
    });
}

// ‚îÄ‚îÄ‚îÄ SHARED COMPONENTS ‚îÄ‚îÄ‚îÄ
const hdr = `<div class="tfc-header"><div class="tfc-header-inner"><a href="/" class="tfc-logo"><span class="tfc-logo-icon">TFC</span><span>The Foundation of Change</span></a><nav class="tfc-nav"><a href="/community-service/">Community Service</a><a href="/states/">State Programs</a><a href="/faq/">FAQ</a><a href="/how-it-works/">How It Works</a><a href="/contact-us/">Contact Us</a><a href="${APP}/login" class="tfc-login">Log In</a><a href="${APP}/how-to-register" class="tfc-get-started">Get Started</a></nav></div></div>`;

const ftr = `<div class="tfc-footer"><div class="tfc-footer-grid"><div class="tfc-footer-col"><h3>About the Program</h3><ul><li><a href="/community-service/">Community Service Program</a></li><li><a href="/how-it-works/">How It Works</a></li><li><a href="/faq/">Frequently Asked Questions</a></li><li><a href="/court-acceptance/">Court Acceptance</a></li><li><a href="/program-details/">Program Details</a></li><li><a href="/states/">State Programs</a></li><li><a href="${APP}/dashboard">My Dashboard</a></li><li><a href="${APP}/coursework">My Coursework</a></li></ul></div><div class="tfc-footer-col"><h3>Verification &amp; Documents</h3><ul><li><a href="${APP}/certificate-verification">Verify a Certificate</a></li><li><a href="/enrollment-letter/">Sample Enrollment Letter</a></li><li><a href="/terms-of-service/">Attendance Policy</a></li><li><a href="/refund-policy/">Refund Policy</a></li></ul></div><div class="tfc-footer-col"><h3>Contact Us</h3><div class="tfc-footer-contact"><a href="mailto:info@thefoundationofchange.org">info@thefoundationofchange.org</a><a href="tel:+17348346934">734-834-6934</a><a href="/contact-us/">Secure Contact Form</a></div></div></div><div class="tfc-partner-section"><p class="tfc-partner-label">Other Programs ‚Äî In Partnership With Schroeder Counseling</p><div class="tfc-partner-links"><a href="https://www.schroedercounseling.com/court-approved-anger-management-classes" target="_blank" rel="noopener">Anger Management Classes</a><a href="https://www.schroedercounseling.com/substance-abuse-asssessments" target="_blank" rel="noopener">Substance Abuse Assessments</a><a href="https://www.schroedercounseling.com/drug-and-alcohol" target="_blank" rel="noopener">Alcohol Education Classes</a><a href="https://www.schroedercounseling.com/theft-awareness-class" target="_blank" rel="noopener">Theft Awareness Classes</a></div></div><div class="tfc-bottom-bar"><p class="tfc-copyright">&copy; 2025 The Foundation of Change ‚Äî 501(c)(3) Nonprofit ‚Äî EIN: 33-5003265</p><div class="tfc-legal-links"><a href="/privacy-policy-2/">Privacy</a><a href="/terms-of-service/">Terms &amp; Conditions</a><a href="/refund-policy/">Refund Policy</a></div></div></div>`;

// ‚îÄ‚îÄ‚îÄ ALL 50 STATES ‚îÄ‚îÄ‚îÄ
const states = [
    { slug: 'alabama', name: 'Alabama', abbr: 'AL', cities: ['Birmingham', 'Huntsville', 'Mobile', 'Montgomery', 'Tuscaloosa'], counties: 67, courtInfo: 'circuit courts, district courts, and municipal courts', geoContext: "From the Gulf Coast to the Appalachian foothills, Alabama residents benefit from the flexibility of completing community service online. Many rural communities have limited access to traditional service organizations.", neighbors: ['florida', 'georgia', 'mississippi', 'tennessee'] },
    { slug: 'alaska', name: 'Alaska', abbr: 'AK', cities: ['Anchorage', 'Fairbanks', 'Juneau', 'Sitka', 'Ketchikan'], counties: 30, courtInfo: 'superior courts, district courts, and magistrate courts', geoContext: "With vast distances between communities and extreme weather conditions, Alaska residents face unique challenges accessing traditional community service. Our online program eliminates geographic barriers entirely.", neighbors: ['washington'] },
    { slug: 'arizona', name: 'Arizona', abbr: 'AZ', cities: ['Phoenix', 'Tucson', 'Mesa', 'Scottsdale', 'Chandler'], counties: 15, courtInfo: 'superior courts, justice courts, and municipal courts', geoContext: "From the Phoenix metro area to rural desert communities, Arizona residents can complete their hours from anywhere with an internet connection ‚Äî no commuting in the heat required.", neighbors: ['california', 'colorado', 'nevada', 'new-mexico', 'utah'] },
    { slug: 'arkansas', name: 'Arkansas', abbr: 'AR', cities: ['Little Rock', 'Fort Smith', 'Fayetteville', 'Springdale', 'Jonesboro'], counties: 75, courtInfo: 'circuit courts, district courts, and city courts', geoContext: "Arkansas's mix of urban centers and rural communities makes online community service an ideal option. Residents from the Ozarks to the Delta can complete hours without long drives.", neighbors: ['louisiana', 'mississippi', 'missouri', 'oklahoma', 'tennessee', 'texas'] },
    { slug: 'california', name: 'California', abbr: 'CA', cities: ['Los Angeles', 'San Francisco', 'San Diego', 'Sacramento', 'San Jose'], counties: 58, courtInfo: 'superior courts across all 58 counties', geoContext: "As the most populous state, California has extensive court-ordered community service requirements. Our program serves residents from San Diego to the Oregon border with a flexible, court-accepted solution.", neighbors: ['arizona', 'nevada', 'oregon'] },
    { slug: 'colorado', name: 'Colorado', abbr: 'CO', cities: ['Denver', 'Colorado Springs', 'Aurora', 'Fort Collins', 'Boulder'], counties: 64, courtInfo: 'district courts, county courts, and municipal courts', geoContext: "Colorado's mountain communities and Front Range cities alike benefit from online community service. Whether you're in Denver or a ski town, complete your hours from anywhere.", neighbors: ['arizona', 'kansas', 'nebraska', 'new-mexico', 'oklahoma', 'utah', 'wyoming'] },
    { slug: 'connecticut', name: 'Connecticut', abbr: 'CT', cities: ['Hartford', 'New Haven', 'Bridgeport', 'Stamford', 'Waterbury'], counties: 8, courtInfo: 'superior courts and housing courts', geoContext: "Despite being one of the smallest states, Connecticut has busy court systems in its major cities. Our online program provides a convenient alternative to traditional service placements.", neighbors: ['massachusetts', 'new-york', 'rhode-island'] },
    { slug: 'delaware', name: 'Delaware', abbr: 'DE', cities: ['Wilmington', 'Dover', 'Newark', 'Middletown', 'Bear'], counties: 3, courtInfo: 'superior courts, Court of Common Pleas, and justice of the peace courts', geoContext: "Delaware's compact size means court requirements are consistent statewide. Our program is accepted by courts across all three counties for community service fulfillment.", neighbors: ['maryland', 'new-jersey', 'pennsylvania'] },
    { slug: 'florida', name: 'Florida', abbr: 'FL', cities: ['Miami', 'Orlando', 'Tampa', 'Jacksonville', 'Fort Lauderdale'], counties: 67, courtInfo: 'circuit courts and county courts across all 67 counties', geoContext: "Florida's large population and active court system generate significant demand for community service programs. From the Panhandle to the Keys, residents can complete hours entirely online.", neighbors: ['alabama', 'georgia'] },
    { slug: 'georgia', name: 'Georgia', abbr: 'GA', cities: ['Atlanta', 'Savannah', 'Augusta', 'Columbus', 'Macon'], counties: 159, courtInfo: 'superior courts, state courts, and magistrate courts', geoContext: "With 159 counties ‚Äî the second most in the nation ‚Äî Georgia's court system is vast. Our online program serves residents across the entire state without requiring travel to service sites.", neighbors: ['alabama', 'florida', 'north-carolina', 'south-carolina', 'tennessee'] },
    { slug: 'hawaii', name: 'Hawaii', abbr: 'HI', cities: ['Honolulu', 'Hilo', 'Kailua', 'Pearl City', 'Waipahu'], counties: 5, courtInfo: 'circuit courts and district courts', geoContext: "Hawaii's island geography makes traditional community service challenging for inter-island residents. Our online program is especially valuable for those on neighbor islands with fewer local options.", neighbors: [] },
    { slug: 'idaho', name: 'Idaho', abbr: 'ID', cities: ['Boise', 'Meridian', 'Nampa', 'Idaho Falls', 'Pocatello'], counties: 44, courtInfo: 'district courts and magistrate courts', geoContext: "Idaho's vast rural areas make in-person community service challenging. Online hours are an ideal solution for residents in remote communities throughout the state.", neighbors: ['montana', 'nevada', 'oregon', 'utah', 'washington', 'wyoming'] },
    { slug: 'illinois', name: 'Illinois', abbr: 'IL', cities: ['Chicago', 'Aurora', 'Naperville', 'Rockford', 'Springfield'], counties: 102, courtInfo: 'circuit courts across 24 judicial circuits', geoContext: "From Chicago's busy court system to downstate communities, Illinois residents can complete community service requirements online. Our program is designed to meet the needs of Illinois's diverse population.", neighbors: ['indiana', 'iowa', 'kentucky', 'missouri', 'wisconsin'] },
    { slug: 'indiana', name: 'Indiana', abbr: 'IN', cities: ['Indianapolis', 'Fort Wayne', 'Evansville', 'South Bend', 'Carmel'], counties: 92, courtInfo: 'circuit courts, superior courts, and city/town courts', geoContext: "Indiana's court system spans 92 counties with varying community service requirements. Our online program provides a consistent, accepted option statewide.", neighbors: ['illinois', 'kentucky', 'michigan', 'ohio'] },
    { slug: 'iowa', name: 'Iowa', abbr: 'IA', cities: ['Des Moines', 'Cedar Rapids', 'Davenport', 'Sioux City', 'Iowa City'], counties: 99, courtInfo: 'district courts across eight judicial districts', geoContext: "Iowa's rural character means many residents are far from traditional service opportunities. Online community service bridges the gap for Iowans in all 99 counties.", neighbors: ['illinois', 'minnesota', 'missouri', 'nebraska', 'south-dakota', 'wisconsin'] },
    { slug: 'kansas', name: 'Kansas', abbr: 'KS', cities: ['Wichita', 'Overland Park', 'Kansas City', 'Olathe', 'Topeka'], counties: 105, courtInfo: 'district courts across 31 judicial districts', geoContext: "Kansas stretches over 400 miles from east to west, making travel to service sites impractical for many. Our online option ensures all Kansas residents can fulfill their obligations.", neighbors: ['colorado', 'missouri', 'nebraska', 'oklahoma'] },
    { slug: 'kentucky', name: 'Kentucky', abbr: 'KY', cities: ['Louisville', 'Lexington', 'Bowling Green', 'Covington', 'Owensboro'], counties: 120, courtInfo: 'circuit courts and district courts', geoContext: "Kentucky's 120 counties include many rural areas in Appalachia where in-person service options are limited. Our online program ensures all residents can meet their requirements.", neighbors: ['illinois', 'indiana', 'missouri', 'ohio', 'tennessee', 'virginia', 'west-virginia'] },
    { slug: 'louisiana', name: 'Louisiana', abbr: 'LA', cities: ['New Orleans', 'Baton Rouge', 'Shreveport', 'Lafayette', 'Lake Charles'], counties: 64, courtInfo: 'district courts across 42 judicial districts (parishes)', geoContext: "Louisiana's parish system and active court scene make our online program a popular choice. From New Orleans to rural parishes, residents can complete hours without travel.", neighbors: ['arkansas', 'mississippi', 'texas'] },
    { slug: 'maine', name: 'Maine', abbr: 'ME', cities: ['Portland', 'Lewiston', 'Bangor', 'South Portland', 'Auburn'], counties: 16, courtInfo: 'superior courts and district courts', geoContext: "Maine's vast rural landscape and harsh winters make traveling to service sites difficult. Our online program lets residents complete hours from home year-round.", neighbors: ['new-hampshire'] },
    { slug: 'maryland', name: 'Maryland', abbr: 'MD', cities: ['Baltimore', 'Columbia', 'Germantown', 'Silver Spring', 'Waldorf'], counties: 24, courtInfo: 'circuit courts and district courts', geoContext: "Maryland serves a diverse population from urban Baltimore to rural Eastern Shore communities. Our program provides a flexible option accepted by courts throughout the state.", neighbors: ['delaware', 'pennsylvania', 'virginia', 'west-virginia'] },
    { slug: 'massachusetts', name: 'Massachusetts', abbr: 'MA', cities: ['Boston', 'Worcester', 'Springfield', 'Cambridge', 'Lowell'], counties: 14, courtInfo: 'superior courts, district courts, and Boston Municipal Court', geoContext: "Massachusetts' busy courts frequently assign community service. Our online program provides an efficient option for residents across the Commonwealth.", neighbors: ['connecticut', 'new-hampshire', 'new-york', 'rhode-island', 'vermont'] },
    { slug: 'michigan', name: 'Michigan', abbr: 'MI', cities: ['Detroit', 'Grand Rapids', 'Ann Arbor', 'Lansing', 'Flint'], counties: 83, courtInfo: 'circuit courts, district courts, and probate courts', geoContext: "Michigan's two peninsulas create unique geographic challenges. Our online program serves residents from the Upper Peninsula to Metro Detroit equally.", neighbors: ['indiana', 'ohio', 'wisconsin'] },
    { slug: 'minnesota', name: 'Minnesota', abbr: 'MN', cities: ['Minneapolis', 'Saint Paul', 'Rochester', 'Duluth', 'Bloomington'], counties: 87, courtInfo: 'district courts across ten judicial districts', geoContext: "Minnesota's long winters and geographic spread make online community service especially practical. Complete your hours comfortably from any location in the state.", neighbors: ['iowa', 'north-dakota', 'south-dakota', 'wisconsin'] },
    { slug: 'mississippi', name: 'Mississippi', abbr: 'MS', cities: ['Jackson', 'Gulfport', 'Southaven', 'Hattiesburg', 'Biloxi'], counties: 82, courtInfo: 'circuit courts, chancery courts, and justice courts', geoContext: "Mississippi's rural communities often lack traditional service organizations. Our online program bridges this gap, serving residents from the Delta to the Gulf Coast.", neighbors: ['alabama', 'arkansas', 'louisiana', 'tennessee'] },
    { slug: 'missouri', name: 'Missouri', abbr: 'MO', cities: ['Kansas City', 'St. Louis', 'Springfield', 'Columbia', 'Independence'], counties: 115, courtInfo: 'circuit courts across 46 judicial circuits', geoContext: "Missouri's large court system spanning 115 counties generates significant community service requirements. Our program serves urban and rural residents alike.", neighbors: ['arkansas', 'illinois', 'iowa', 'kansas', 'kentucky', 'nebraska', 'oklahoma', 'tennessee'] },
    { slug: 'montana', name: 'Montana', abbr: 'MT', cities: ['Billings', 'Missoula', 'Great Falls', 'Bozeman', 'Helena'], counties: 56, courtInfo: 'district courts, justice courts, and city courts', geoContext: "Montana's vast open spaces mean you could drive hours to reach a service site. Online community service eliminates this barrier for residents across the Big Sky state.", neighbors: ['idaho', 'north-dakota', 'south-dakota', 'wyoming'] },
    { slug: 'nebraska', name: 'Nebraska', abbr: 'NE', cities: ['Omaha', 'Lincoln', 'Bellevue', 'Grand Island', 'Kearney'], counties: 93, courtInfo: 'district courts and county courts', geoContext: "Nebraska's 93 counties include many with small populations and limited service options. Our online program ensures all Nebraskans can fulfill their community service obligations.", neighbors: ['colorado', 'iowa', 'kansas', 'missouri', 'south-dakota', 'wyoming'] },
    { slug: 'nevada', name: 'Nevada', abbr: 'NV', cities: ['Las Vegas', 'Henderson', 'Reno', 'North Las Vegas', 'Sparks'], counties: 17, courtInfo: 'district courts, justice courts, and municipal courts', geoContext: "While Las Vegas and Reno have robust court systems, Nevada's rural counties cover vast desert areas. Our online option serves residents statewide without travel requirements.", neighbors: ['arizona', 'california', 'idaho', 'oregon', 'utah'] },
    { slug: 'new-hampshire', name: 'New Hampshire', abbr: 'NH', cities: ['Manchester', 'Nashua', 'Concord', 'Derry', 'Dover'], counties: 10, courtInfo: 'superior courts, circuit courts, and district courts', geoContext: "New Hampshire's small-town character means community service options can be limited in many areas. Our online program provides a convenient alternative accepted statewide.", neighbors: ['maine', 'massachusetts', 'vermont'] },
    { slug: 'new-jersey', name: 'New Jersey', abbr: 'NJ', cities: ['Newark', 'Jersey City', 'Paterson', 'Elizabeth', 'Trenton'], counties: 21, courtInfo: 'superior courts with vicinage divisions across 15 vicinages', geoContext: "New Jersey's dense population creates high demand for community service programs. Our online option eliminates wait times and scheduling conflicts common with in-person placements.", neighbors: ['delaware', 'new-york', 'pennsylvania'] },
    { slug: 'new-mexico', name: 'New Mexico', abbr: 'NM', cities: ['Albuquerque', 'Las Cruces', 'Rio Rancho', 'Santa Fe', 'Roswell'], counties: 33, courtInfo: 'district courts, magistrate courts, and metropolitan courts', geoContext: "New Mexico's low population density and vast distances between communities make online service ideal. Residents from Albuquerque to rural tribal communities can participate equally.", neighbors: ['arizona', 'colorado', 'oklahoma', 'texas', 'utah'] },
    { slug: 'new-york', name: 'New York', abbr: 'NY', cities: ['New York City', 'Buffalo', 'Rochester', 'Syracuse', 'Albany'], counties: 62, courtInfo: 'supreme courts, county courts, city courts, and town/village courts', geoContext: "New York's massive court system handles millions of cases annually. From Manhattan courts to upstate rural communities, our program provides a flexible, accepted alternative.", neighbors: ['connecticut', 'massachusetts', 'new-jersey', 'pennsylvania', 'vermont'] },
    { slug: 'north-carolina', name: 'North Carolina', abbr: 'NC', cities: ['Charlotte', 'Raleigh', 'Greensboro', 'Durham', 'Winston-Salem'], counties: 100, courtInfo: 'superior courts and district courts across 100 counties', geoContext: "North Carolina's growing population and active courts generate significant community service demand. Our program serves residents from the coast to the mountains.", neighbors: ['georgia', 'south-carolina', 'tennessee', 'virginia'] },
    { slug: 'north-dakota', name: 'North Dakota', abbr: 'ND', cities: ['Fargo', 'Bismarck', 'Grand Forks', 'Minot', 'West Fargo'], counties: 53, courtInfo: 'district courts across seven judicial districts', geoContext: "North Dakota's sparse population and extreme weather make in-person community service especially challenging. Online hours are the practical solution for most residents.", neighbors: ['minnesota', 'montana', 'south-dakota'] },
    { slug: 'ohio', name: 'Ohio', abbr: 'OH', cities: ['Columbus', 'Cleveland', 'Cincinnati', 'Toledo', 'Akron'], counties: 88, courtInfo: 'courts of common pleas, municipal courts, and county courts', geoContext: "Ohio's 88 counties host one of the nation's busiest court systems. Our online program is a proven solution for residents across the Buckeye State.", neighbors: ['indiana', 'kentucky', 'michigan', 'pennsylvania', 'west-virginia'] },
    { slug: 'oklahoma', name: 'Oklahoma', abbr: 'OK', cities: ['Oklahoma City', 'Tulsa', 'Norman', 'Broken Arrow', 'Edmond'], counties: 77, courtInfo: 'district courts across 26 judicial districts', geoContext: "Oklahoma's court system spans 77 counties with community service frequently assigned. Our online program provides a convenient, accepted option for all Oklahoma residents.", neighbors: ['arkansas', 'colorado', 'kansas', 'missouri', 'new-mexico', 'texas'] },
    { slug: 'oregon', name: 'Oregon', abbr: 'OR', cities: ['Portland', 'Salem', 'Eugene', 'Gresham', 'Hillsboro'], counties: 36, courtInfo: 'circuit courts across 27 judicial districts', geoContext: "Oregon stretches from the Pacific Coast to high desert. Online community service ensures equal access for residents in both the Willamette Valley cities and remote eastern communities.", neighbors: ['california', 'idaho', 'nevada', 'washington'] },
    { slug: 'pennsylvania', name: 'Pennsylvania', abbr: 'PA', cities: ['Philadelphia', 'Pittsburgh', 'Allentown', 'Erie', 'Reading'], counties: 67, courtInfo: 'courts of common pleas, magisterial district courts, and municipal courts', geoContext: "Pennsylvania's 67 counties span from Philadelphia's busy courts to rural Appalachian communities. Our online program bridges the urban-rural divide for community service fulfillment.", neighbors: ['delaware', 'maryland', 'new-jersey', 'new-york', 'ohio', 'west-virginia'] },
    { slug: 'rhode-island', name: 'Rhode Island', abbr: 'RI', cities: ['Providence', 'Warwick', 'Cranston', 'Pawtucket', 'East Providence'], counties: 5, courtInfo: 'superior courts and district courts', geoContext: "Despite its small size, Rhode Island has an active court system. Our online program provides a flexible option for residents across the Ocean State.", neighbors: ['connecticut', 'massachusetts'] },
    { slug: 'south-carolina', name: 'South Carolina', abbr: 'SC', cities: ['Charleston', 'Columbia', 'Greenville', 'North Charleston', 'Myrtle Beach'], counties: 46, courtInfo: 'circuit courts and magistrate courts', geoContext: "South Carolina's courts regularly assign community service hours. Our online program serves residents from the Upstate to the Lowcountry with equal convenience.", neighbors: ['georgia', 'north-carolina'] },
    { slug: 'south-dakota', name: 'South Dakota', abbr: 'SD', cities: ['Sioux Falls', 'Rapid City', 'Aberdeen', 'Brookings', 'Watertown'], counties: 66, courtInfo: 'circuit courts across seven judicial circuits', geoContext: "South Dakota's wide-open landscape and low population density create significant barriers to traditional community service. Our online program is the practical choice.", neighbors: ['iowa', 'minnesota', 'montana', 'nebraska', 'north-dakota', 'wyoming'] },
    { slug: 'tennessee', name: 'Tennessee', abbr: 'TN', cities: ['Nashville', 'Memphis', 'Knoxville', 'Chattanooga', 'Clarksville'], counties: 95, courtInfo: 'circuit courts, criminal courts, and general sessions courts', geoContext: "Tennessee's 95 counties stretch from Memphis to the Smoky Mountains. Our online program serves all residents equally, regardless of location.", neighbors: ['alabama', 'arkansas', 'georgia', 'kentucky', 'mississippi', 'missouri', 'north-carolina', 'virginia'] },
    { slug: 'texas', name: 'Texas', abbr: 'TX', cities: ['Houston', 'Dallas', 'San Antonio', 'Austin', 'Fort Worth'], counties: 254, courtInfo: 'district courts, county courts, and justice of the peace courts', geoContext: "Texas is massive ‚Äî spanning 268,596 square miles with 254 counties. Our online program eliminates the geographic barriers that make traditional community service impractical in much of the state.", neighbors: ['arkansas', 'louisiana', 'new-mexico', 'oklahoma'] },
    { slug: 'utah', name: 'Utah', abbr: 'UT', cities: ['Salt Lake City', 'West Valley City', 'Provo', 'West Jordan', 'Orem'], counties: 29, courtInfo: 'district courts and justice courts', geoContext: "Utah's geography ranges from the Wasatch Front to remote desert communities. Online community service ensures equal access for all Utah residents.", neighbors: ['arizona', 'colorado', 'idaho', 'nevada', 'new-mexico', 'wyoming'] },
    { slug: 'vermont', name: 'Vermont', abbr: 'VT', cities: ['Burlington', 'South Burlington', 'Rutland', 'Barre', 'Montpelier'], counties: 14, courtInfo: 'superior courts across 14 units', geoContext: "Vermont's rural character and long winters make accessing traditional service sites challenging. Our online program is perfectly suited for Green Mountain State residents.", neighbors: ['massachusetts', 'new-hampshire', 'new-york'] },
    { slug: 'virginia', name: 'Virginia', abbr: 'VA', cities: ['Virginia Beach', 'Norfolk', 'Chesapeake', 'Richmond', 'Arlington'], counties: 95, courtInfo: 'circuit courts, general district courts, and juvenile courts', geoContext: "Virginia's court system includes 95 counties and over 30 independent cities. Our online program provides a consistent option accepted throughout the Commonwealth.", neighbors: ['kentucky', 'maryland', 'north-carolina', 'tennessee', 'west-virginia'] },
    { slug: 'washington', name: 'Washington', abbr: 'WA', cities: ['Seattle', 'Spokane', 'Tacoma', 'Vancouver', 'Bellevue'], counties: 39, courtInfo: 'superior courts, district courts, and municipal courts', geoContext: "Washington state stretches from the Puget Sound to the inland desert. Online community service bridges the gap between urban Seattle and rural eastern Washington.", neighbors: ['idaho', 'oregon'] },
    { slug: 'west-virginia', name: 'West Virginia', abbr: 'WV', cities: ['Charleston', 'Huntington', 'Morgantown', 'Parkersburg', 'Wheeling'], counties: 55, courtInfo: 'circuit courts and magistrate courts', geoContext: "West Virginia's mountainous terrain makes travel to service sites difficult for many residents. Our online option is especially valuable in this geographically challenging state.", neighbors: ['kentucky', 'maryland', 'ohio', 'pennsylvania', 'virginia'] },
    { slug: 'wisconsin', name: 'Wisconsin', abbr: 'WI', cities: ['Milwaukee', 'Madison', 'Green Bay', 'Kenosha', 'Racine'], counties: 72, courtInfo: 'circuit courts across ten judicial administrative districts', geoContext: "Wisconsin's 72 counties include major cities and extensive rural areas. Our online program serves residents from the shores of Lake Michigan to the Mississippi River bluffs.", neighbors: ['illinois', 'iowa', 'michigan', 'minnesota'] },
    { slug: 'wyoming', name: 'Wyoming', abbr: 'WY', cities: ['Cheyenne', 'Casper', 'Laramie', 'Gillette', 'Rock Springs'], counties: 23, courtInfo: 'district courts and circuit courts', geoContext: "Wyoming is the least populous state, with vast distances between communities. Online community service is often the only practical option for residents in this frontier state.", neighbors: ['colorado', 'idaho', 'montana', 'nebraska', 'south-dakota', 'utah'] },
];

function buildPage(s) {
    const { name, abbr, cities, counties, courtInfo, geoContext, neighbors } = s;
    const citiesStr = cities.slice(0, -1).join(', ') + ', and ' + cities[cities.length - 1];

    const neighborLinks = neighbors.map(nSlug => {
        const ns = states.find(st => st.slug === nSlug);
        return ns ? `<a href="/${ns.slug}/" class="tfc-nearby-link">Online Community Service in ${ns.name}</a>` : '';
    }).filter(Boolean).join('');

    const cityCards = cities.map(city =>
        `<div class="tfc-step-card"><span class="tfc-step-icon">üìç</span><h3>Community Service in ${city}, ${abbr}</h3><p>Residents of ${city}, ${name} can complete court-ordered, probation-required, or school-mandated community service hours entirely online. Our program is accepted by ${city} area courts and provides verified certificates with hour logs.</p></div>`
    ).join('');

    return hdr + `
<div class="tfc-hero"><div class="tfc-hero-overlay"></div><div class="tfc-hero-content"><div class="tfc-badges"><span class="tfc-badge">‚úì Court-Approved</span><span class="tfc-badge">‚úì Probation-Compliant</span><span class="tfc-badge">‚úì ${name} Accepted</span></div><h1>Complete Your Community Service Hours in ${name}<span class="tfc-accent"> ‚Äî 100% Online</span></h1><p>A verified 501(c)(3) nonprofit program accepted by ${name} courts, probation officers, and schools. Start from home ‚Äî finish on your schedule.</p><div class="tfc-hero-cta"><a href="${APP}/how-to-register" class="tfc-cta-primary">Enroll Now ‚Äî Start Your ${abbr} Hours Today</a><a href="/contact-us/" class="tfc-cta-secondary">Have Questions? Contact Us</a></div></div></div>
<div class="tfc-stats"><div class="tfc-stats-inner"><div class="tfc-stat-item"><span class="tfc-stat-value">10,000+</span><span class="tfc-stat-label">HOURS COMPLETED</span></div><div class="tfc-stat-item"><span class="tfc-stat-value">50</span><span class="tfc-stat-label">STATES COVERED</span></div><div class="tfc-stat-item"><span class="tfc-stat-value">4.9‚òÖ</span><span class="tfc-stat-label">SATISFACTION RATING</span></div><div class="tfc-stat-item"><span class="tfc-stat-value">501(c)(3)</span><span class="tfc-stat-label">VERIFIED NONPROFIT</span></div></div></div>
<div class="tfc-section"><div class="container"><h2 class="tfc-section-title">How Online Community Service Works in ${name}</h2><p class="tfc-section-subtitle">Three simple steps to complete your community service requirement from anywhere in ${name}.</p><div class="tfc-steps"><div class="tfc-step-card"><div class="tfc-step-number">1</div><span class="tfc-step-icon">üìã</span><h3>Choose Your Hours</h3><p>Select the exact number of community service hours you need ‚Äî from 1 to 1,000.</p></div><div class="tfc-step-card"><div class="tfc-step-number">2</div><span class="tfc-step-icon">üíª</span><h3>Complete Coursework</h3><p>Work through self-paced educational modules on accountability, personal growth, and community awareness.</p></div><div class="tfc-step-card"><div class="tfc-step-number">3</div><span class="tfc-step-icon">üìú</span><h3>Download Certificate</h3><p>Instantly receive your verified certificate of completion with a unique verification code.</p></div></div></div></div>
<div class="tfc-section-alt"><div class="container"><h2 class="tfc-section-title">Is This Program Right For You?</h2><p class="tfc-section-subtitle">Whatever your situation in ${name}, we&apos;re here to help you move forward.</p><div class="tfc-audience-grid"><div class="tfc-audience-card"><span class="tfc-audience-icon">‚öñÔ∏è</span><h3>Court-Ordered Hours in ${name}?</h3><p>Fulfill your court-mandated community service through our verified online program. Accepted by ${name} ${courtInfo} across all ${counties} counties.</p><a href="${APP}/how-to-register" class="tfc-audience-cta">Start Your ${name} Court Hours ‚Üí</a></div><div class="tfc-audience-card"><span class="tfc-audience-icon">üéì</span><h3>${name} Graduation Requirement?</h3><p>Earn service credit for graduation on your own schedule from anywhere in ${name}. Accepted by schools statewide.</p><a href="${APP}/how-to-register" class="tfc-audience-cta">Earn Your ${name} Credit ‚Üí</a></div><div class="tfc-audience-card"><span class="tfc-audience-icon">ü§ù</span><h3>${name} Probation Requirement?</h3><p>Complete probation-mandated community service from the comfort of home. Certificates accepted by ${name} probation departments.</p><a href="${APP}/how-to-register" class="tfc-audience-cta">Get ${abbr} Compliant ‚Üí</a></div></div></div></div>
<div class="tfc-mid-cta"><div class="container" style="text-align:center"><p class="tfc-mid-cta-text">Ready to start? Most ${name} participants finish within 1‚Äì2 weeks.</p><a href="${APP}/how-to-register" class="tfc-cta-primary">Complete Your ${name} Hours Now ‚Üí</a></div></div>
<div class="tfc-section"><div class="container"><div class="tfc-seo-inner"><h2>Online Community Service in ${name} ‚Äî What You Need to Know</h2><h3>${name} Court System and Community Service</h3><p>${name}&apos;s court system includes ${courtInfo} across all ${counties} counties. Courts in <strong>${citiesStr}</strong> regularly assign community service as part of sentencing for misdemeanor offenses, DUI cases, and first-time offender programs. Our certificate provides the verified documentation ${name} courts require.</p><h3>Why ${name} Residents Choose Online Community Service</h3><p>${geoContext}</p><h3>${name} County Coverage</h3><ul><li>Available in all <strong>${counties} ${name} counties</strong></li><li>Serving metro areas: <strong>${citiesStr}</strong></li><li>${name}&apos;s ${courtInfo} recognize 501(c)(3) certificates</li><li>No in-person visits needed ‚Äî complete from home on any device</li><li><a href="${APP}/certificate-verification">Verify any certificate online</a></li></ul><h3>Verification and Acceptance</h3><p>Every certificate includes a unique verification code that ${name} courts and probation officers can independently verify through our <a href="${APP}/certificate-verification">online verification portal</a>. We provide detailed hour logs showing dates, times, and hours completed. Our 501(c)(3) nonprofit status provides the legitimacy ${name} courts expect.</p><h3>Getting Started in ${name}</h3><p>Enroll today and begin your hours immediately. There are no deadlines ‚Äî work at your own pace with an 8-hour daily maximum. Your progress saves automatically on any device. Upon completion, your certificate and hour log are instantly available. <a href="${APP}/how-to-register" style="font-weight:600">Start your ${name} community service hours now</a>.</p></div></div></div>
<div class="tfc-section-alt"><div class="container"><h2 class="tfc-section-title">Serving Communities Across ${name}</h2><p class="tfc-section-subtitle">Our online community service program is available to residents in every ${name} city and county.</p><div class="tfc-steps">${cityCards}</div></div></div>
<div class="tfc-section-alt"><div class="container"><h2 class="tfc-section-title">Why ${name} Residents Choose The Foundation of Change</h2><p class="tfc-section-subtitle">Everything you need to complete your community service with confidence.</p><div class="tfc-trust-grid"><div class="tfc-trust-card"><span class="tfc-trust-icon">üèõÔ∏è</span><h3>Court Compliant</h3><p>Accepted by ${name} courts and probation departments statewide.</p></div><div class="tfc-trust-card"><span class="tfc-trust-icon">üîí</span><h3>Audit Ready</h3><p>Tamper-proof time tracking with verification logs for every session.</p></div><div class="tfc-trust-card"><span class="tfc-trust-icon">üìÑ</span><h3>501(c)(3) Nonprofit</h3><p>Registered nonprofit ‚Äî your hours carry legitimate weight.</p></div><div class="tfc-trust-card"><span class="tfc-trust-icon">‚è∞</span><h3>Self-Paced</h3><p>No deadlines. Complete hours at your pace from anywhere in ${name}.</p></div></div></div></div>
<div class="tfc-section"><div class="container"><h2 class="tfc-section-title">Frequently Asked Questions</h2><p class="tfc-section-subtitle">${name} Community Service ‚Äî Answered</p><div class="tfc-faq-list"><div class="tfc-faq-item"><button class="tfc-faq-q" onclick="this.parentElement.classList.toggle('open')"><span>Is online community service accepted by ${name} courts?</span><span class="tfc-faq-chevron">+</span></button><div class="tfc-faq-a"><p>Our 501(c)(3) nonprofit program provides verified certificates with unique verification codes. Many ${name} courts accept online community service programs. We recommend confirming with your specific court or probation officer before enrolling.</p></div></div><div class="tfc-faq-item"><button class="tfc-faq-q" onclick="this.parentElement.classList.toggle('open')"><span>How do I prove my hours to my ${name} probation officer?</span><span class="tfc-faq-chevron">+</span></button><div class="tfc-faq-a"><p>You receive a certificate of completion and detailed hour log, both with a verification code your probation officer can verify through our online verification portal.</p></div></div><div class="tfc-faq-item"><button class="tfc-faq-q" onclick="this.parentElement.classList.toggle('open')"><span>How many hours can I complete per day?</span><span class="tfc-faq-chevron">+</span></button><div class="tfc-faq-a"><p>Up to 8 hours per day. The daily limit resets at midnight in your local timezone to ensure meaningful engagement.</p></div></div><div class="tfc-faq-item"><button class="tfc-faq-q" onclick="this.parentElement.classList.toggle('open')"><span>How long do I have to finish?</span><span class="tfc-faq-chevron">+</span></button><div class="tfc-faq-a"><p>There is no deadline. Complete hours at your own pace. Progress saves automatically.</p></div></div><div class="tfc-faq-item"><button class="tfc-faq-q" onclick="this.parentElement.classList.toggle('open')"><span>What does the coursework cover?</span><span class="tfc-faq-chevron">+</span></button><div class="tfc-faq-a"><p>Coursework covers accountability, emotional regulation, decision-making, community awareness, and personal growth through self-paced educational modules and written reflections.</p></div></div></div></div></div>
<div class="tfc-final-cta"><div class="tfc-final-cta-glow"></div><div class="tfc-final-cta-content"><h2>Start Your ${name} Community Service Hours Today</h2><p>Join participants across ${name} who have completed their hours online through our verified nonprofit program.</p><a href="${APP}/how-to-register" class="tfc-cta-primary">Complete Your ${name} Hours ‚Äî Enroll Now</a></div></div>
${neighborLinks ? `<div class="tfc-nearby"><div class="tfc-nearby-inner"><h3>Community Service in Nearby States</h3><div class="tfc-nearby-grid">${neighborLinks}</div><p style="margin-top:1rem;text-align:center"><a href="/states/" style="opacity:0.8">View all 50 state programs ‚Üí</a></p></div></div>` : ''}
` + ftr;
}

async function main() {
    // Step 1: Auth check
    console.log('Testing authentication...');
    const authTest = await wpAPI('/wp-json/wp/v2/users/me');
    if (authTest.status !== 200) {
        console.log('Auth failed (status ' + authTest.status + '):', typeof authTest.body === 'string' ? authTest.body : JSON.stringify(authTest.body).substring(0, 300));
        process.exit(1);
    }
    console.log('‚úì Authenticated as:', authTest.body.name);

    // Step 2: Get all pages
    console.log('\nFetching all existing pages...');
    let allPages = [];
    for (let pg = 1; pg <= 3; pg++) {
        const res = await wpAPI(`/wp-json/wp/v2/pages?per_page=100&page=${pg}&_fields=id,slug`);
        if (Array.isArray(res.body)) allPages = allPages.concat(res.body);
        else break;
    }
    console.log(`Found ${allPages.length} pages`);

    // Step 3: Update each state
    let ok = 0, fail = 0, skip = 0;
    for (let i = 0; i < states.length; i++) {
        const s = states[i];
        const match = allPages.find(p => p.slug === s.slug);
        if (!match) {
            console.log(`  ‚úó ${s.abbr} ${s.name} ‚Äî page not found (slug: ${s.slug})`);
            fail++;
            continue;
        }

        const content = buildPage(s);
        const title = `Online Community Service Hours in ${s.name}`;

        const res = await wpAPI(`/wp-json/wp/v2/pages/${match.id}`, 'PUT', { title, content });
        if (res.status === 200 && res.body.id) {
            ok++;
            process.stdout.write(`  ‚úì ${s.abbr} `);
            if (ok % 10 === 0) console.log('');
        } else {
            console.log(`  ‚úó ${s.abbr} ${s.name} ‚Äî update failed (${res.status})`);
            fail++;
        }
    }

    console.log(`\n\n‚ïê‚ïê‚ïê RESULTS ‚ïê‚ïê‚ïê`);
    console.log(`‚úì Updated: ${ok}/50`);
    console.log(`‚úó Failed:  ${fail}/50`);
    console.log(`Done!`);
}

main().catch(console.error);
